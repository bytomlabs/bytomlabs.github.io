<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="25_contract_template" />
	<meta name="description" content="25_contract_template" />
	<!-- 网页标签标题 -->
	<title>25_contract_template</title>
	<link rel="shortcut icon" href="/img/docsite.ico"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><div class="header-body"><a href="/zh-cn/index.html"><img class="logo" src="/img/dubbo_colorful.png"/></a><div class="search search-normal"><span class="icon-search"></span></div><span class="language-switch language-switch-normal">En</span><div class="header-menu"><img class="header-menu-toggle" src="/img/system/menu_gray.png"/><ul><li class="menu-item menu-item-normal menu-item-normal-active"><a href="/zh-cn/docs/00_index.html" target="_self">文档</a></li></ul></div></div></header><div class="bar"><div class="bar-body"><img src="/img/system/docs.png" class="front-img"/><span>文档</span><img src="/img/system/docs.png" class="back-img"/></div></div><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>认识比原</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/00_index.html" target="_self">概述</a></li><li style="height:288px;overflow:hidden" class="menu-item menu-item-level-2"><span>设计原理和架构<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/13_architecture_overview.html" target="_self">整体架构概览</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/14_key.html" target="_self">秘钥</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/15_address.html" target="_self">地址</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/16_account.html" target="_self">账户</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/17_transaction.html" target="_self">交易</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/18_block.html" target="_self">区块</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/19_utxo.html" target="_self">UTXO</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/20_consensus.html" target="_self">共识算法</a></li><li style="height:180px;overflow:hidden" class="menu-item menu-item-level-2"><span>智能合约<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/22_smart_contract_overview.html" target="_self">概述</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/23_smart_contract_build.html" target="_self">构造流程</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/24_contract_operator.html" target="_self">操作符介绍</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/25_contract_template.html" target="_self">合约模板</a></li></ul></li><li style="height:108px;overflow:hidden" class="menu-item menu-item-level-2"><span>侧链<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/30_sidechain_overview.html" target="_self">概述</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/31_sidechain.html" target="_self">配置节点</a></li></ul></li></ul></li><li class="menu-item menu-item-level-1"><span>开发者指南</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/06_build_environment.html" target="_self">搭建开发环境</a></li><li style="height:108px;overflow:hidden" class="menu-item menu-item-level-2"><span>编译运行全节点<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/07_compile_and_run_node.html" target="_self">安装与运行</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/demo2.html" target="_self">docker运行比原全节点</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/08_rpc_call.html" target="_self">全节点RPC接口调用</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/09_ws_call.html" target="_self">Websocket使用说明</a></li></ul></li><li class="menu-item menu-item-level-1"><span>快速学习</span><ul><li style="height:144px;overflow:hidden" class="menu-item menu-item-level-2"><span>DAPP开发指南<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/dapp/1_dapp.html" target="_self">安装与运行</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/dapp/2_dapp.html" target="_self">配置节点</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/dapp/3_dapp.html" target="_self">命令行工具</a></li></ul></li><li style="height:144px;overflow:hidden" class="menu-item menu-item-level-2"><span>开发资料集合<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/collection/1_collection.html" target="_self">文档</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/collection/2_collection.html" target="_self">配置节点</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/collection/3_collection.html" target="_self">命令行工具</a></li></ul></li></ul></li><li class="menu-item menu-item-level-1"><span>对接指南</span><ul><li style="height:144px;overflow:hidden" class="menu-item menu-item-level-2"><span>交易所对接指南<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/exchange/1_exchange.html" target="_self">安装与运行</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/exchange/2_exchange.html" target="_self">配置节点</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/exchange/3_exchange.html" target="_self">配置节点</a></li></ul></li><li style="height:144px;overflow:hidden" class="menu-item menu-item-level-2"><span>钱包所对接指南<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/wallet/1_wallet.html" target="_self">安装与运行</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/wallet/2_wallet.html" target="_self">配置节点</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/wallet/3_wallet.html" target="_self">开始挖矿</a></li></ul></li></ul></li><li class="menu-item menu-item-level-1"><span>SDK集锦</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/10_other_sdk.html" target="_self">第三方SDK</a></li></ul></li><li class="menu-item menu-item-level-1"><span>生态圈</span><ul><li style="height:180px;overflow:hidden" class="menu-item menu-item-level-2"><span>比原生态<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/26_wallet.html" target="_self">全节点钱包</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/27_ligth_wallet.html" target="_self">轻钱包</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/28_block_explorer.html" target="_self">区块链浏览器</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/29_mining_pool.html" target="_self">矿池</a></li></ul></li><li style="height:72px;overflow:hidden" class="menu-item menu-item-level-2"><span>落地应用<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/application/1_application.html" target="_self">应用</a></li></ul></li></ul></li></ul></div><div class="doc-content markdown-body"><h2>典型合约模板解析</h2>
<h3>单签验证合约</h3>
<p><code>LockWithPublicKey</code>源代码如下：</p>
<pre><code>contract LockWithPublicKey(publicKey: PublicKey) locks valueAmount of valueAsset {
  clause unlockWithSig(sig: Signature) {
    verify checkTxSig(publicKey, sig)
    unlock valueAmount of valueAsset
  }
}
</code></pre>
<ul>
<li>合约编译之后的字节码为：<code>ae7cac</code></li>
<li>合约对应的指令码为：<code>TXSIGHASH SWAP CHECKSIG</code></li>
</ul>
<p>假如合约参数如下：</p>
<ul>
<li><code>publicKey</code> : e9108d3ca8049800727f6a3505b3a2710dc579405dde03c250f16d9a7e1e6e78</li>
</ul>
<p>添加合约参数后的合约程序如下：<code>20e9108d3ca8049800727f6a3505b3a2710dc579405dde03c250f16d9a7e1e6e787403ae7cac00c0</code></p>
<p>对应的解锁合约的参数如下：</p>
<ul>
<li><code>sig</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
    <span class="hljs-string">"derivation_path"</span>: [
      <span class="hljs-string">"010100000000000000"</span>,
      <span class="hljs-string">"0100000000000000"</span>
    ]
  }
}
</code></pre>
<p>对应的解锁合约交易模板示例如下：</p>
<pre><code class="language-js">{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"913d941faf5a19501ab4c06747fe1eb38c5ae76b74d0f5af524fc40ee6bf7116"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
            <span class="hljs-string">"derivation_path"</span>: [
              <span class="hljs-string">"010100000000000000"</span>,
              <span class="hljs-string">"0100000000000000"</span>
            ]
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">100000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014c5a5b563c4623018557fb299259542b8739f6bc2"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
<h3>多签验证合约</h3>
<p><code>LockWithMultiSig</code>源代码如下：</p>
<pre><code>contract LockWithMultiSig(publicKey1: PublicKey,
                        publicKey2: PublicKey,
                        publicKey3: PublicKey) locks valueAmount of valueAsset {
  clause spend(sig1: Signature, sig2: Signature) {
    verify checkTxMultiSig([publicKey1, publicKey2, publicKey3], [sig1, sig2])
    unlock valueAmount of valueAsset
  }
}
</code></pre>
<ul>
<li>合约编译之后的字节码为：<code>537a547a526bae71557a536c7cad</code></li>
<li>合约对应的指令码为：<code>3 ROLL 4 ROLL 2 TOALTSTACK TXSIGHASH 2ROT 5 ROLL 3 FROMALTSTACK SWAP CHECKMULTISIG</code></li>
</ul>
<p>假如合约参数如下：</p>
<ul>
<li><code>publicKey1</code> : e9108d3ca8049800727f6a3505b3a2710dc579405dde03c250f16d9a7e1e6e78</li>
<li><code>publicKey2</code> : 1f51c25decab2168835f1292a5432707ed94b90be8f5ec0d62aca1c6daa1ec55</li>
<li><code>publicKey3</code> : e386c85178418fc72f8182111aa818ac736f3f7f1eee75ccdd7e5a057abe8fe0</li>
</ul>
<p>添加合约参数后的合约程序如下：（注意添加合约参数的顺序与虚拟机入栈的顺序是相反的）<code>20e386c85178418fc72f8182111aa818ac736f3f7f1eee75ccdd7e5a057abe8fe0201f51c25decab2168835f1292a5432707ed94b90be8f5ec0d62aca1c6daa1ec5520e9108d3ca8049800727f6a3505b3a2710dc579405dde03c250f16d9a7e1e6e78740e537a547a526bae71557a536c7cad00c0</code></p>
<p>对应的解锁合约的参数如下：（注意解锁合约参数的顺序，否则会执行VM失败）</p>
<ul>
<li><code>sig1</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
    <span class="hljs-string">"derivation_path"</span>: [
      <span class="hljs-string">"010100000000000000"</span>,
      <span class="hljs-string">"0100000000000000"</span>
    ]
  }
}
</code></pre>
<ul>
<li><code>sig2</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"e0f470a91bcd99497b4804d76264a293e257ca906938a43e34a6a0e619bbf5f1606a2866eca2ceec9f93348c577b052f30bb7ef41b4b09fff28eb1004ca1f8d5"</span>,
    <span class="hljs-string">"derivation_path"</span>: [
      <span class="hljs-string">"010200000000000000"</span>,
      <span class="hljs-string">"0100000000000000"</span>
    ]
  }
}
</code></pre>
<p>对应的解锁合约交易模板示例如下：</p>
<pre><code class="language-js">{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"bf6a3999cfbd25cef24ff1b19c6f2e0988de2e8ef3d40ed7c15402f2a7327bfa"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
            <span class="hljs-string">"derivation_path"</span>: [
              <span class="hljs-string">"010100000000000000"</span>,
              <span class="hljs-string">"0100000000000000"</span>
            ]
          }
        },
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"e0f470a91bcd99497b4804d76264a293e257ca906938a43e34a6a0e619bbf5f1606a2866eca2ceec9f93348c577b052f30bb7ef41b4b09fff28eb1004ca1f8d5"</span>,
            <span class="hljs-string">"derivation_path"</span>: [
              <span class="hljs-string">"010200000000000000"</span>,
              <span class="hljs-string">"0100000000000000"</span>
            ]
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">200000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014c5a5b563c4623018557fb299259542b8739f6bc2"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
<h3>pubkey哈希校验和单签验证合约</h3>
<p><code>LockWithPublicKeyHash</code>源代码如下：</p>
<pre><code>contract LockWithPublicKeyHash(pubKeyHash: Hash) locks valueAmount of valueAsset {
  clause spend(pubKey: PublicKey, sig: Signature) {
    verify sha3(pubKey) == pubKeyHash
    verify checkTxSig(pubKey, sig)
    unlock valueAmount of valueAsset
  }
}
</code></pre>
<ul>
<li>合约编译之后的字节码为：<code>5279aa887cae7cac</code></li>
<li>合约对应的指令码为：<code>2 PICK SHA3 EQUALVERIFY SWAP TXSIGHASH SWAP CHECKSIG</code></li>
</ul>
<p>假如合约参数如下：</p>
<ul>
<li><code>pubKeyHash</code> : b3f37834dfa74174e9f0d208302e77c637cfe66c3e37fe1e1574e416b3516e89</li>
</ul>
<p>添加合约参数后的合约程序如下：<code>20b3f37834dfa74174e9f0d208302e77c637cfe66c3e37fe1e1574e416b3516e8974085279aa887cae7cac00c0</code></p>
<p>对应的解锁合约的参数如下：（注意解锁合约参数的顺序，否则会执行VM失败）</p>
<ul>
<li><code>pubKey</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"b3f37834dfa74174e9f0d208302e77c637cfe66c3e37fe1e1574e416b3516e89"</span>
  }
}
</code></pre>
<ul>
<li><code>sig</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
    <span class="hljs-string">"derivation_path"</span>: [
      <span class="hljs-string">"010100000000000000"</span>,
      <span class="hljs-string">"0100000000000000"</span>
    ]
  }
}
</code></pre>
<p>对应的解锁合约交易模板示例如下：</p>
<pre><code class="language-js">{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"f98e0aa007dec76a827e924c25678e8c04b922fb28da9f5513a92787ac53725b"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-string">"b3f37834dfa74174e9f0d208302e77c637cfe66c3e37fe1e1574e416b3516e89"</span>
          }
        },
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
            <span class="hljs-string">"derivation_path"</span>: [
              <span class="hljs-string">"010100000000000000"</span>,
              <span class="hljs-string">"0100000000000000"</span>
            ]
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">300000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014c5a5b563c4623018557fb299259542b8739f6bc2"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
<h3>字符串哈希校验合约</h3>
<p><code>RevealPreimage</code>源代码如下：</p>
<pre><code>contract RevealPreimage(hash: Hash) locks valueAmount of valueAsset {
  clause reveal(string: String) {
    verify sha3(string) == hash
    unlock valueAmount of valueAsset
  }
}
</code></pre>
<ul>
<li>合约编译之后的字节码为：<code>7caa87</code></li>
<li>合约对应的指令码为：<code>SWAP SHA3 EQUAL</code></li>
</ul>
<p>假如合约参数如下：</p>
<ul>
<li><code>hash</code> : 22e829107201c6b975b1dc60b928117916285ceb4aa5c6d7b4b8cc48038083e0</li>
</ul>
<p>添加合约参数后的合约程序如下：<code>2022e829107201c6b975b1dc60b928117916285ceb4aa5c6d7b4b8cc48038083e074037caa8700c0</code></p>
<p>对应的解锁合约的参数如下：（注意解锁合约参数的顺序，否则会执行VM失败）</p>
<ul>
<li><code>string</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"string"</span>
  }
}
</code></pre>
<p>或者 （<code>string</code>的16进制为<code>737472696e67</code>）</p>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"737472696e67"</span>
  }
}
</code></pre>
<p>对应的解锁合约交易模板示例如下：</p>
<pre><code class="language-js">{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"35fe216572bea7d81effd2fed2db1bc257f977dfa492299742a0dee2a9ae1c8e"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-string">"string"</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">400000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014c5a5b563c4623018557fb299259542b8739f6bc2"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
<h3>币币交易合约</h3>
<p><code>TradeOffer</code>源代码如下：</p>
<pre><code>contract TradeOffer(assetRequested: Asset,
                  amountRequested: Amount,
                  seller: Program,
                  cancelKey: PublicKey) locks valueAmount of valueAsset {
  clause trade() {
    lock amountRequested of assetRequested with seller
    unlock valueAmount of valueAsset
  }
  clause cancel(sellerSig: Signature) {
    verify checkTxSig(cancelKey, sellerSig)
    unlock valueAmount of valueAsset
  }
}
</code></pre>
<ul>
<li>合约编译之后的字节码为：<code>547a6413000000007b7b51547ac1631a000000547a547aae7cac</code></li>
<li>合约对应的指令码为：<code>4 ROLL JUMPIF:$cancel $trade FALSE ROT ROT 1 4 ROLL CHECKOUTPUT JUMP:$_end $cancel 4 ROLL 4 ROLL TXSIGHASH SWAP CHECKSIG $_end</code></li>
</ul>
<p>假如合约参数如下：</p>
<ul>
<li><code>assetRequested</code> : 1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22</li>
<li><code>amountRequested</code> : 99</li>
<li><code>seller</code> : 0014c5a5b563c4623018557fb299259542b8739f6bc2</li>
<li><code>cancelKey</code> : e9108d3ca8049800727f6a3505b3a2710dc579405dde03c250f16d9a7e1e6e78</li>
</ul>
<p>添加合约参数后的合约程序如下：<code>20e9108d3ca8049800727f6a3505b3a2710dc579405dde03c250f16d9a7e1e6e78160014c5a5b563c4623018557fb299259542b8739f6bc20163201e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22741a547a6413000000007b7b51547ac1631a000000547a547aae7cac00c0</code></p>
<p>对应的解锁合约的参数如下：（注意该合约包含两个<code>clause</code>，在解锁合约的时候任选其一即可，其中<code>clause_selector</code>指的是选择的解锁<code>clause</code>在合约中的位置（位置序号从<code>0</code>开始计算），此外还需注意解锁合约参数的顺序，否则会执行VM失败）</p>
<ul>
<li>
<p><code>clause trade</code> 解锁参数 :</p>
<ul>
<li><code>clause_selector</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
  }
}
</code></pre>
<p>或</p>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"00"</span>
  }
}
</code></pre>
<ul>
<li><code>lock</code>语句的交易<code>action</code>构造 : <code>lock amountRequested of assetRequested with seller</code>语句表示解锁账户需要支付对应的<code>amountRequested</code>数量的<code>assetRequested</code>资产到对应的接收对象<code>seller</code>，注意上述参数必须严格匹配，否则合约执行将失败.</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"amount"</span>: <span class="hljs-number">99</span>,
  <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"2a1861ba3a5f7bbdb98392b33289465b462fe8e9d4b9c00f78cbcb1ac20fa93f"</span>,
  <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014c5a5b563c4623018557f299259542b8739f6bc2"</span>,
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
},
{
  <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JJF0KG0A06"</span>,
  <span class="hljs-string">"amount"</span>: <span class="hljs-number">99</span>,
  <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"2a1861ba3a5f7bbdb98392b33289465b462fe8e9d4b9c00f78cbcb1ac20fa93f"</span>,
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
}
</code></pre>
<p>对应的解锁合约交易模板示例如下：</p>
<pre><code class="language-js"><span class="hljs-comment">// clause trade</span>
{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"9f3a63d2f8352a6891dadd8a8337268873c84a852594f35b0b9815a4b9d56d86"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">99</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014c5a5b563c4623018557fb299259542b8739f6bc2"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">99</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">500000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"2a1861ba3a5f7bbdb98392b33289465b462fe8e9d4b9c00f78cbcb1ac20fa93f"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014905df16bc248790676744bab063a1ae810803bd7"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
</li>
<li>
<p><code>clause cancel</code> 解锁参数 :（注意参数顺序）</p>
<ul>
<li><code>sellerSig</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
    <span class="hljs-string">"derivation_path"</span>: [
      <span class="hljs-string">"010100000000000000"</span>,
      <span class="hljs-string">"0100000000000000"</span>
    ]
  }
}
</code></pre>
<ul>
<li><code>clause_selector</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">1</span>
  }
}
</code></pre>
<p>或</p>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"01"</span>
  }
}
</code></pre>
<p>对应的解锁合约交易模板示例如下:</p>
<pre><code class="language-js"><span class="hljs-comment">// clause cancel</span>
{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"9f3a63d2f8352a6891dadd8a8337268873c84a852594f35b0b9815a4b9d56d86"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
            <span class="hljs-string">"derivation_path"</span>: [
              <span class="hljs-string">"010100000000000000"</span>,
              <span class="hljs-string">"0100000000000000"</span>
            ]
          }
        },
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">1</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">500000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014929ec7d92f89d74716ba9591eaea588aa1867f75"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
</li>
</ul>
<h3>第三方信任机构托管合约</h3>
<p><code>Escrow</code>源代码如下：</p>
<pre><code>contract Escrow(agent: PublicKey,
              sender: Program,
              recipient: Program) locks valueAmount of valueAsset {
  clause approve(sig: Signature) {
    verify checkTxSig(agent, sig)
    lock valueAmount of valueAsset with recipient
  }
  clause reject(sig: Signature) {
    verify checkTxSig(agent, sig)
    lock valueAmount of valueAsset with sender
  }
}
</code></pre>
<ul>
<li>合约编译之后的字节码为：<code>537a641a000000537a7cae7cac6900c3c251557ac16328000000537a7cae7cac6900c3c251547ac1</code></li>
<li>合约对应的指令码为：<code>3 ROLL JUMPIF:$reject $approve 3 ROLL SWAP TXSIGHASH SWAP CHECKSIG VERIFY FALSE AMOUNT ASSET 1 5 ROLL CHECKOUTPUT JUMP:$_end $reject 3 ROLL SWAP TXSIGHASH SWAP CHECKSIG VERIFY FALSE AMOUNT ASSET 1 4 ROLL CHECKOUTPUT $_end</code></li>
</ul>
<p>假如合约参数如下：</p>
<ul>
<li><code>agent</code> : e9108d3ca8049800727f6a3505b3a2710dc579405dde03c250f16d9a7e1e6e78</li>
<li><code>sender</code> : 0014905df16bc248790676744bab063a1ae810803bd7</li>
<li><code>recipient</code> : 0014929ec7d92f89d74716ba9591eaea588aa1867f75</li>
</ul>
<p>添加合约参数后的合约程序如下：<code>160014929ec7d92f89d74716ba9591eaea588aa1867f75160014905df16bc248790676744bab063a1ae810803bd720e9108d3ca8049800727f6a3505b3a2710dc579405dde03c250f16d9a7e1e6e787428537a641a000000537a7cae7cac6900c3c251557ac16328000000537a7cae7cac6900c3c251547ac100c0</code></p>
<p>对应的解锁合约的参数如下：（注意该合约包含两个<code>clause</code>，在解锁合约的时候任选其一即可，其中<code>clause_selector</code>指的是选择的解锁<code>clause</code>在合约中的位置（位置序号从<code>0</code>开始计算），此外还需注意解锁合约参数的顺序，否则会执行VM失败）</p>
<ul>
<li>
<p><code>clause approve</code> 解锁参数 :</p>
<ul>
<li><code>sellerSig</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
    <span class="hljs-string">"derivation_path"</span>: [
      <span class="hljs-string">"010100000000000000"</span>,
      <span class="hljs-string">"0100000000000000"</span>
    ]
  }
}
</code></pre>
<ul>
<li><code>clause_selector</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
  }
}
</code></pre>
<p>或</p>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"00"</span>
  }
}
</code></pre>
<p>对应的解锁合约交易模板示例如下:（注意接收<code>control_program</code>字段必须为<code>recipient</code>，否则执行失败）</p>
<pre><code class="language-js"><span class="hljs-comment">// clause approve</span>
{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"15ee3368e77a0699eadaf99bbc096a48595ac975d05b10b198d902dde808e120"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
            <span class="hljs-string">"derivation_path"</span>: [
              <span class="hljs-string">"010100000000000000"</span>,
              <span class="hljs-string">"0100000000000000"</span>
            ]
          }
        },
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">600000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014929ec7d92f89d74716ba9591eaea588aa1867f75"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
</li>
<li>
<p><code>clause reject</code> 解锁参数 :</p>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
    <span class="hljs-string">"derivation_path"</span>: [
      <span class="hljs-string">"010100000000000000"</span>,
      <span class="hljs-string">"0100000000000000"</span>
    ]
  }
}
</code></pre>
<ul>
<li><code>clause_selector</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">1</span>
  }
}
</code></pre>
<p>或</p>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"01"</span>
  }
}
</code></pre>
<p>对应的解锁合约交易模板示例如下:（注意接收<code>control_program</code>字段必须为<code>sender</code>，否则执行失败）</p>
<pre><code class="language-js"><span class="hljs-comment">// clause reject</span>
{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"15ee3368e77a0699eadaf99bbc096a48595ac975d05b10b198d902dde808e120"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
            <span class="hljs-string">"derivation_path"</span>: [
              <span class="hljs-string">"010100000000000000"</span>,
              <span class="hljs-string">"0100000000000000"</span>
            ]
          }
        },
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">1</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">600000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014905df16bc248790676744bab063a1ae810803bd7"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
</li>
</ul>
<hr>
<h3>抵押贷款合约</h3>
<p><code>LoanCollateral</code>源代码如下：</p>
<pre><code>contract LoanCollateral(assetLoaned: Asset,
                      amountLoaned: Amount,
                      blockHeight: Integer,
                      lender: Program,
                      borrower: Program) locks valueAmount of valueAsset {
  clause repay() {
    lock amountLoaned of assetLoaned with lender
    lock valueAmount of valueAsset with borrower
  }
  clause default() {
    verify above(blockHeight)
    lock valueAmount of valueAsset with lender
  }
}
</code></pre>
<ul>
<li>合约编译之后的字节码为：<code>557a641b000000007b7b51557ac16951c3c251557ac163260000007bcd9f6900c3c251567ac1</code></li>
<li>合约对应的指令码为：<code>5 ROLL JUMPIF:$default $repay FALSE ROT ROT 1 5 ROLL CHECKOUTPUT VERIFY 1 AMOUNT ASSET 1 5 ROLL CHECKOUTPUT JUMP:$_end $default ROT BLOCKHEIGHT LESSTHAN VERIFY FALSE AMOUNT ASSET 1 6 ROLL CHECKOUTPUT $_end</code></li>
</ul>
<p>假如合约参数如下：</p>
<ul>
<li><code>assetLoaned</code> : 1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22</li>
<li><code>amountLoaned</code> : 88</li>
<li><code>blockHeight</code> : 1920</li>
<li><code>lender</code> : 0014905df16bc248790676744bab063a1ae810803bd7</li>
<li><code>borrower</code> : 0014929ec7d92f89d74716ba9591eaea588aa1867f75</li>
</ul>
<p>添加合约参数后的合约程序如下：<code>160014929ec7d92f89d74716ba9591eaea588aa1867f75160014905df16bc248790676744bab063a1ae810803bd70280070158201e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c227426557a641b000000007b7b51557ac16951c3c251557ac163260000007bcd9f6900c3c251567ac100c0</code></p>
<p>对应的解锁合约的参数如下：（注意该合约包含两个<code>clause</code>，在解锁合约的时候任选其一即可，其中<code>clause_selector</code>指的是选择的解锁<code>clause</code>在合约中的位置（位置序号从<code>0</code>开始计算），此外还需注意解锁合约参数的顺序，否则会执行VM失败）</p>
<ul>
<li>
<p><code>clause repay</code> 解锁参数 :</p>
<ul>
<li><code>clause_selector</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
  }
}
</code></pre>
<p>或</p>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"00"</span>
  }
}
</code></pre>
<ul>
<li>连续两个<code>lock</code>语句的交易<code>action</code>构造 : <code>lock amountLoaned of assetLoaned with lender</code>语句表示解锁账户需要支付对应的<code>amountLoaned</code>数量的<code>assetLoaned</code>资产到对应的接收对象<code>lender</code>; <code>lock valueAmount of valueAsset with borrower</code>语句表示将合约锁定的<code>valueAmount</code>数量的<code>valueAsset</code>资产到对应的接收对象<code>borrower</code>。注意上述参数必须严格匹配，否则合约执行将失败.</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"amount"</span>: <span class="hljs-number">88</span>,
  <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
  <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014905df16bc248790676744bab063a1ae810803bd7"</span>,
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
},
{
  <span class="hljs-string">"amount"</span>: <span class="hljs-number">700000000</span>,
  <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"2ee76aeaa110308fcdfb382fa02a4a35823d5a589ffcaddb23f11f8a1fae3302"</span>,
  <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014929ec7d92f89d74716ba9591eaea588aa1867f75"</span>,
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
},
{
  <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
  <span class="hljs-string">"amount"</span>: <span class="hljs-number">88</span>,
  <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
}
</code></pre>
<p>对应的解锁合约交易模板示例如下：</p>
<pre><code class="language-js"><span class="hljs-comment">// clause repay</span>
{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"3cf74c303558b7343cfa20b32ccddfd8e66293ae1970f7612ca6cb9a006e76bc"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">88</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014905df16bc248790676744bab063a1ae810803bd7"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">700000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"2ee76aeaa110308fcdfb382fa02a4a35823d5a589ffcaddb23f11f8a1fae3302"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014929ec7d92f89d74716ba9591eaea588aa1867f75"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">88</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
</li>
<li>
<p><code>clause default</code> 解锁参数 :（注意参数顺序）</p>
<ul>
<li><code>clause_selector</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">1</span>
  }
}
</code></pre>
<p>或</p>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"01"</span>
  }
}
</code></pre>
<p>对应的解锁合约交易模板示例如下:（注意接收<code>control_program</code>字段必须为<code>lender</code>，否则执行失败）</p>
<pre><code class="language-js"><span class="hljs-comment">// clause default</span>
{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"3cf74c303558b7343cfa20b32ccddfd8e66293ae1970f7612ca6cb9a006e76bc"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">1</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">700000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014905df16bc248790676744bab063a1ae810803bd7"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
</li>
</ul>
<h3>看涨期权合约</h3>
<p><code>CallOption</code>源代码如下：</p>
<pre><code>contract CallOption(strikePrice: Amount,
                  strikeCurrency: Asset,
                  seller: Program,
                  buyerKey: PublicKey,
                  blockHeight: Integer) locks valueAmount of valueAsset {
  clause exercise(buyerSig: Signature) {
    verify below(blockHeight)
    verify checkTxSig(buyerKey, buyerSig)
    lock strikePrice of strikeCurrency with seller
    unlock valueAmount of valueAsset
  }
  clause expire() {
    verify above(blockHeight)
    lock valueAmount of valueAsset with seller
  }
}
</code></pre>
<ul>
<li>合约编译之后的字节码为：<code>557a6420000000547acda069547a547aae7cac69007c7b51547ac1632c000000547acd9f6900c3c251567ac1</code></li>
<li>合约对应的指令码为：<code>5 ROLL JUMPIF:$expire $exercise FALSE ROT ROT 1 5 ROLL CHECKOUTPUT VERIFY 1 AMOUNT ASSET 1 5 ROLL CHECKOUTPUT JUMP:$_end $expire ROT BLOCKHEIGHT LESSTHAN VERIFY FALSE AMOUNT ASSET 1 6 ROLL CHECKOUTPUT $_end</code></li>
</ul>
<p>假如合约参数如下：</p>
<ul>
<li><code>strikePrice</code> : 199</li>
<li><code>strikeCurrency</code> : 1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22</li>
<li><code>seller</code> : 0014905df16bc248790676744bab063a1ae810803bd7</li>
<li><code>buyerKey</code> : e9108d3ca8049800727f6a3505b3a2710dc579405dde03c250f16d9a7e1e6e78</li>
<li><code>blockHeight</code> : 3096</li>
</ul>
<p>添加合约参数后的合约程序如下：<code>02180c20e9108d3ca8049800727f6a3505b3a2710dc579405dde03c250f16d9a7e1e6e78160014905df16bc248790676744bab063a1ae810803bd7201e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c2201c7742c557a6420000000547acda069547a547aae7cac69007c7b51547ac1632c000000547acd9f6900c3c251567ac100c0</code></p>
<p>对应的解锁合约的参数如下：（注意该合约包含两个<code>clause</code>，在解锁合约的时候任选其一即可，其中<code>clause_selector</code>指的是选择的解锁<code>clause</code>在合约中的位置（位置序号从<code>0</code>开始计算），此外还需注意解锁合约参数的顺序，否则会执行VM失败）</p>
<ul>
<li>
<p><code>clause exercise</code> 解锁参数 :</p>
<ul>
<li><code>buyerSig</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
    <span class="hljs-string">"derivation_path"</span>: [
      <span class="hljs-string">"010100000000000000"</span>,
      <span class="hljs-string">"0100000000000000"</span>
    ]
  }
}
</code></pre>
<ul>
<li><code>clause_selector</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
  }
}
</code></pre>
<p>或</p>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"00"</span>
  }
}
</code></pre>
<ul>
<li><code>lock</code>语句的交易<code>action</code>构造 : <code>lock strikePrice of strikeCurrency with seller</code>语句表示解锁账户需要支付对应的<code>strikePrice</code>数量的<code>strikeCurrency</code>资产到对应的接收对象<code>seller</code>，注意上述参数必须严格匹配，否则合约执行将失败.</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"amount"</span>: <span class="hljs-number">199</span>,
  <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
  <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014c5a5b563c4623018557fb299259542b8739f6bc2"</span>,
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
},
{
  <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
  <span class="hljs-string">"amount"</span>: <span class="hljs-number">199</span>,
  <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
}
</code></pre>
<p>对应的解锁合约交易模板示例如下：</p>
<pre><code class="language-js"><span class="hljs-comment">// clause exercise</span>
{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"7afa15ad39356a7e6dc363fba823146ecb0132967f067ddfa13494a34a984518"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"5c6145b241b1147987565719657a0506ebb417a2e110a235a42cfb40951880f447432f930ce9fd1a6b7e51b3ddbfdc7adb57d33448f93c0defb4de630703a144"</span>,
            <span class="hljs-string">"derivation_path"</span>: [
              <span class="hljs-string">"010100000000000000"</span>,
              <span class="hljs-string">"0100000000000000"</span>
            ]
          }
        },
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">199</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014c5a5b563c4623018557fb299259542b8739f6bc2"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">199</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">800000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"2a1861ba3a5f7bbdb98392b33289465b462fe8e9d4b9c00f78cbcb1ac20fa93f"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014905df16bc248790676744bab063a1ae810803bd7"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
</li>
<li>
<p><code>clause expire</code> 解锁参数 :</p>
<ul>
<li><code>clause_selector</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">1</span>
  }
}
</code></pre>
<p>或</p>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"01"</span>
  }
}
</code></pre>
<p>对应的解锁合约交易模板示例如下:（注意接收<code>control_program</code>字段必须为<code>seller</code>，否则执行失败）</p>
<pre><code class="language-js"><span class="hljs-comment">// clause expire</span>
{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"7afa15ad39356a7e6dc363fba823146ecb0132967f067ddfa13494a34a984518"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">1</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">800000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"1e074b22ed7ae8470c7ba5d8a7bc95e83431a753a17465e8673af68a82500c22"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014905df16bc248790676744bab063a1ae810803bd7"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0G1JIR6400A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
</li>
</ul>
<h3>可修改价格的币币交易合约</h3>
<p><code>PriceChanger</code>源代码如下：</p>
<pre><code>contract PriceChanger(askAmount: Amount, askAsset: Asset, sellerKey: PublicKey, sellerProg: Program) locks valueAmount of valueAsset {
  clause changePrice(newAmount: Amount, newAsset: Asset, sig: Signature) {
    verify checkTxSig(sellerKey, sig)
    lock valueAmount of valueAsset with PriceChanger(newAmount, newAsset, sellerKey, sellerProg)
  }
  clause redeem() {
    lock askAmount of askAsset with sellerProg
    unlock valueAmount of valueAsset
  }
}
</code></pre>
<ul>
<li>合约编译之后的字节码为：<code>557a6432000000557a5479ae7cac6900c3c25100597a89587a89587a89587a89557a890274787e008901c07ec1633a000000007b537a51567ac1</code></li>
<li>合约对应的指令码为：<code>5 05 ROLL JUMPIF:$redeem $changePrice 5 05 ROLL 4 04 PICK TXSIGHASH SWAP CHECKSIG VERIFY FALSE AMOUNT ASSET 1 01 FALSE 9 09 ROLL CATPUSHDATA 8 08 ROLL CATPUSHDATA 8 08 ROLL CATPUSHDATA 8 08 ROLL CATPUSHDATA 5 05 ROLL CATPUSHDATA DATA_2 7478 CAT FALSE CATPUSHDATA DATA_1 c0 CAT CHECKOUTPUT JUMP:$_end $redeem FALSE ROT 3 03 ROLL 1 01 6 06 ROLL CHECKOUTPUT $_end</code></li>
</ul>
<p>假如合约参数如下：</p>
<ul>
<li><code>askAmount</code> : 20000</li>
<li><code>askAsset</code> : c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee</li>
<li><code>sellerKey</code> : 055539eb36abcaaf127c63ae20e3d049cd28d0f1fe569df84da3aedb018ca1bf</li>
<li><code>sellerProg</code> : 0014dedfd406c591aa221a047a260107f877da92fec5</li>
</ul>
<p>添加合约参数后的合约程序如下：
<code>160014dedfd406c591aa221a047a260107f877da92fec520055539eb36abcaaf127c63ae20e3d049cd28d0f1fe569df84da3aedb018ca1bf20c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee02204e3a557a6432000000557a5479ae7cac6900c3c25100597a89587a89587a89587a89557a890274787e008901c07ec1633a000000007b537a51567ac1747800c0</code></p>
<p>对应的解锁合约的参数如下：（注意该合约包含两个<code>clause</code>，在解锁合约的时候任选其一即可，其中<code>clause_selector</code>指的是选择的解锁<code>clause</code>在合约中的位置（位置序号从<code>0</code>开始计算），此外还需注意解锁合约参数的顺序，否则会执行VM失败）</p>
<ul>
<li>
<p><code>clause changePrice</code> 解锁参数 :</p>
<ul>
<li><code>newAmount</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">10000</span>
  }
}
</code></pre>
<ul>
<li><code>newAsset</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"3addca837514d599c509aed802c0b7671838b363a298cbcb0acb06bc24076cf4"</span>
  }
}
</code></pre>
<ul>
<li><code>sig</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"a4d4f09a04371516d37e1d27f92c9cb41e4b1e7f62762cf23ed3904a9dfd2d794195862fffd00bf7ac373e5891c8d2eb660dc5ff9c040ec4e01f973bbfd31c23"</span>,
    <span class="hljs-string">"derivation_path"</span>: [
      <span class="hljs-string">"010100000000000000"</span>,
      <span class="hljs-string">"0100000000000000"</span>
    ]
  }
}
</code></pre>
<ul>
<li><code>clause_selector</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
  }
}
</code></pre>
<p>合约参数构造完成之后，需要对合约<code>lock</code>语句中接收对象进行指定。该合约中的接收对象是一个新的合约程序，<code>lock valueAmount of valueAsset with PriceChanger(newAmount, newAsset, sellerKey, sellerProg)</code>语句表示合约锁定的资产被重新锁定到合约对象中，因此需要构造实例化的合约程序作为接收对象。接收合约的参数如下：</p>
<ul>
<li><code>newAmount</code> : 10000</li>
<li><code>newAsset</code> : 3addca837514d599c509aed802c0b7671838b363a298cbcb0acb06bc24076cf4</li>
<li><code>sellerKey</code> : 055539eb36abcaaf127c63ae20e3d049cd28d0f1fe569df84da3aedb018ca1bf</li>
<li><code>sellerProg</code> : 0014dedfd406c591aa221a047a260107f877da92fec5</li>
</ul>
<p> 
添加合约参数后的实例化合约程序如下：
<code>160014dedfd406c591aa221a047a260107f877da92fec520055539eb36abcaaf127c63ae20e3d049cd28d0f1fe569df84da3aedb018ca1bf203addca837514d599c509aed802c0b7671838b363a298cbcb0acb06bc24076cf40210273a557a6432000000557a5479ae7cac6900c3c25100597a89587a89587a89587a89557a890274787e008901c07ec1633a000000007b537a51567ac1747800c0</code></p>
<p> 
对应的解锁合约交易模板示例如下：</p>
<pre><code class="language-js"><span class="hljs-comment">// clause changePrice</span>
{
<span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
<span class="hljs-string">"actions"</span>: [
    {
    <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"31feac2f482f48dd99117569a3148d1b84211d41b64a980dc9ec37bda922b0c8"</span>,
    <span class="hljs-string">"arguments"</span>: [
        {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
        <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">10000</span>
        }
        },
        {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"data"</span>,
        <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-string">"3addca837514d599c509aed802c0b7671838b363a298cbcb0acb06bc24076cf4"</span>
        }
        },
        {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"raw_tx_signature"</span>,
        <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"xpub"</span>: <span class="hljs-string">"a4d4f09a04371516d37e1d27f92c9cb41e4b1e7f62762cf23ed3904a9dfd2d794195862fffd00bf7ac373e5891c8d2eb660dc5ff9c040ec4e01f973bbfd31c23"</span>,
            <span class="hljs-string">"derivation_path"</span>: [
            <span class="hljs-string">"010100000000000000"</span>,
            <span class="hljs-string">"0100000000000000"</span>
            ]
        }
        },
        {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
        <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
        }
        }
    ],
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
    <span class="hljs-string">"amount"</span>: <span class="hljs-number">900</span>,
    <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"2a62180553e70131f668639116d6d1e29417537766b5244cbe49fa6b36c5d7b0"</span>,
    <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"160014dedfd406c591aa221a047a260107f877da92fec520055539eb36abcaaf127c63ae20e3d049cd28d0f1fe569df84da3aedb018ca1bf203addca837514d599c509aed802c0b7671838b363a298cbcb0acb06bc24076cf40210273a557a6432000000557a5479ae7cac6900c3c25100597a89587a89587a89587a89557a890274787e008901c07ec1633a000000007b537a51567ac1747800c0"</span>,
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
    <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0ILGLSTC00A02"</span>,
    <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
    <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
],
<span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
<span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
</li>
<li>
<p><code>clause redeem</code> 解锁参数 :</p>
<ul>
<li><code>clause_selector</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">1</span>
  }
}
</code></pre>
<p>其对应的解锁合约交易模板示例如下:</p>
<pre><code class="language-js"><span class="hljs-comment">// clause redeem</span>
{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"31feac2f482f48dd99117569a3148d1b84211d41b64a980dc9ec37bda922b0c8"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">1</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014dedfd406c591aa221a047a260107f877da92fec5"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0JPC5DBOG0A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0JPC5DBOG0A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">900</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"2a62180553e70131f668639116d6d1e29417537766b5244cbe49fa6b36c5d7b0"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014bf54f5adbbd2dc11bffb50277b5a993cec75e924"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
</li>
</ul>
<h3>可部分借贷的抵押贷款合约</h3>
<p><code>PartLoanCollateral</code>源代码如下：</p>
<pre><code>contract PartLoanCollateral(assetLoaned: Asset,
                        amountLoaned: Amount,
                        blockHeight: Integer,
                        lender: Program,
                        borrower: Program) locks valueAmount of valueAsset {
  clause repay(amountPartLoaned: Amount) {
    if amountPartLoaned &gt; 0 &amp;&amp; amountPartLoaned &lt; amountLoaned {
      lock amountPartLoaned of assetLoaned with lender
      lock valueAmount*amountPartLoaned/amountLoaned of valueAsset with borrower
      lock valueAmount-(valueAmount*amountPartLoaned/amountLoaned) of valueAsset with PartLoanCollateral(assetLoaned, amountLoaned-amountPartLoaned, blockHeight, lender, borrower)
    } else {
      lock amountLoaned of assetLoaned with lender
      lock valueAmount of valueAsset with borrower
    }
  }
  clause default() {
    verify above(blockHeight)
    lock valueAmount of valueAsset with lender
  }
}
</code></pre>
<ul>
<li>合约编译之后的字节码为：<code>567a6477000000567900a0577954799f9a916164630000000057795379515879c16951c3587995547996c2515979c16952c3767c59799555799694c251005a798959798958798957795c7994895679895579890274787e008901c07ec16963720000000070515879c16951c3c2515979c1696383000000537acd9f6900c3c251577ac1</code></li>
<li>合约对应的指令码为：<code>6 06 ROLL JUMPIF:$default $repay 6 06 PICK FALSE GREATERTHAN 7 07 PICK 4 04 PICK LESSTHAN BOOLAND NOT NOP JUMPIF 63000000 FALSE 7 07 PICK 3 03 PICK 1 01 8 08 PICK CHECKOUTPUT VERIFY 1 01 AMOUNT 8 08 PICK MUL 4 04 PICK DIV ASSET 1 01 9 09 PICK CHECKOUTPUT VERIFY 2 02 AMOUNT DUP SWAP 9 09 PICK MUL 5 05 PICK DIV SUB ASSET 1 01 FALSE 10 0a PICK CATPUSHDATA 9 09 PICK CATPUSHDATA 8 08 PICK CATPUSHDATA 7 07 PICK 12 0c PICK SUB CATPUSHDATA 6 06 PICK CATPUSHDATA 5 05 PICK CATPUSHDATA DATA_2 7478 CAT FALSE CATPUSHDATA DATA_1 c0 CAT CHECKOUTPUT VERIFY JUMP 72000000 FALSE 2OVER 1 01 8 08 PICK CHECKOUTPUT VERIFY 1 01 AMOUNT ASSET 1 01 9 09 PICK CHECKOUTPUT VERIFY JUMP:$_end $default 3 03 ROLL BLOCKHEIGHT LESSTHAN VERIFY FALSE AMOUNT ASSET 1 01 7 07 ROLL CHECKOUTPUT $_end</code></li>
</ul>
<p>假如合约参数如下：</p>
<ul>
<li><code>assetLoaned</code> : c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee</li>
<li><code>amountLoaned</code> : 8000</li>
<li><code>blockHeight</code> : 1900</li>
<li><code>lender</code> : 0014dedfd406c591aa221a047a260107f877da92fec5</li>
<li><code>borrower</code> : 0014bf54f5adbbd2dc11bffb50277b5a993cec75e924</li>
</ul>
<p>添加合约参数后的合约程序如下：<code>160014bf54f5adbbd2dc11bffb50277b5a993cec75e924160014dedfd406c591aa221a047a260107f877da92fec5026c0702401f20c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee4c83567a6477000000567900a0577954799f9a916164630000000057795379515879c16951c3587995547996c2515979c16952c3767c59799555799694c251005a798959798958798957795c7994895679895579890274787e008901c07ec16963720000000070515879c16951c3c2515979c1696383000000537acd9f6900c3c251577ac1747800c0</code></p>
<p>对应的解锁合约的参数如下：（注意该合约包含两个<code>clause</code>，在解锁合约的时候任选其一即可，其中<code>clause_selector</code>指的是选择的解锁<code>clause</code>在合约中的位置（位置序号从<code>0</code>开始计算），此外还需注意解锁合约参数的顺序，否则会执行VM失败）</p>
<ul>
<li>
<p><code>clause changePrice</code> 解锁参数 :</p>
<ul>
<li><code>amountPartLoaned</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">2000</span>
  }
}
</code></pre>
<ul>
<li><code>clause_selector</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
  }
}
</code></pre>
<p>从合约中可以看出<code>lock</code>语句位于<code>if-else</code>语句块中，并且<code>if</code>语句下面的<code>lock</code>语句个数跟<code>else</code>语句下的<code>lock</code>语句个数不相同，因此合约解锁之前，需要对语句的执行流程进行预判断。当<code>amountPartLoaned</code>等于2000时，是小于<code>amountLoaned</code>的值8000，所以执行的流程是<code>if</code>语句下面合约流程。此外，<code>lock</code>语句中<code>valueAmount*amountPartLoaned/amountLoaned</code>和<code>valueAmount-(valueAmount*amountPartLoaned/amountLoaned)</code>需要用户在使用之前先计算好，假如合约锁定的资产值<code>valueAmount</code>为3000, 那么<code>valueAmount*amountPartLoaned/amountLoaned</code>的计算结果为750，而<code>valueAmount-(valueAmount*amountPartLoaned/amountLoaned)</code>的计算结果为2250。最后，该合约中的接收对象是一个新的合约程序，<code>lock valueAmount-(valueAmount*amountPartLoaned/amountLoaned) of valueAsset with PartLoanCollateral(assetLoaned, amountLoaned-amountPartLoaned, blockHeight, lender, borrower)</code>语句表示合约锁定的资产被重新锁定到合约对象中，因此需要构造实例化的合约程序作为接收对象。接收合约的参数如下：</p>
<ul>
<li><code>assetLoaned</code> : c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee</li>
<li><code>amountLoaned</code> : 6000</li>
<li><code>blockHeight</code> : 1900</li>
<li><code>lender</code> : 0014dedfd406c591aa221a047a260107f877da92fec5</li>
<li><code>borrower</code> : 0014bf54f5adbbd2dc11bffb50277b5a993cec75e924</li>
</ul>
<p> 
添加合约参数后的实例化合约程序如下：
<code>160014bf54f5adbbd2dc11bffb50277b5a993cec75e924160014dedfd406c591aa221a047a260107f877da92fec5026c0702701720c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee4c83567a6477000000567900a0577954799f9a916164630000000057795379515879c16951c3587995547996c2515979c16952c3767c59799555799694c251005a798959798958798957795c7994895679895579890274787e008901c07ec16963720000000070515879c16951c3c2515979c1696383000000537acd9f6900c3c251577ac1747800c0</code></p>
<p> 
对应的解锁合约交易模板示例如下：</p>
<pre><code class="language-js"><span class="hljs-comment">// clause repay</span>
{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"a80552a346e271aaa7c71d0fa362a6b02aa844bb71a72934db64bc2b9906d0b9"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">2000</span>
          }
        },
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">2000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014dedfd406c591aa221a047a260107f877da92fec5"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">750</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"2a62180553e70131f668639116d6d1e29417537766b5244cbe49fa6b36c5d7b0"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014bf54f5adbbd2dc11bffb50277b5a993cec75e924"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">2250</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"2a62180553e70131f668639116d6d1e29417537766b5244cbe49fa6b36c5d7b0"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"160014bf54f5adbbd2dc11bffb50277b5a993cec75e924160014dedfd406c591aa221a047a260107f877da92fec5026c0702701720c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee4c83567a6477000000567900a0577954799f9a916164630000000057795379515879c16951c3587995547996c2515979c16952c3767c59799555799694c251005a798959798958798957795c7994895679895579890274787e008901c07ec16963720000000070515879c16951c3c2515979c1696383000000537acd9f6900c3c251577ac1747800c0"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0JPC5DBOG0A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">2000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0JPC5DBOG0A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
<p>当<code>amountPartLoaned</code>大于或等于<code>amountLoaned</code>的值8000时，执行的流程是<code>else</code>语句下面合约流程。对应的解锁合约交易模板示例如下：</p>
<pre><code class="language-js"><span class="hljs-comment">// clause repay</span>
{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"a80552a346e271aaa7c71d0fa362a6b02aa844bb71a72934db64bc2b9906d0b9"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">8000</span>
          }
        },
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">0</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">8000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014dedfd406c591aa221a047a260107f877da92fec5"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">3000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"2a62180553e70131f668639116d6d1e29417537766b5244cbe49fa6b36c5d7b0"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014bf54f5adbbd2dc11bffb50277b5a993cec75e924"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0JPC5DBOG0A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">8000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"c6b12af8326df37b8d77c77bfa2547e083cbacde15cc48da56d4aa4e4235a3ee"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0JPC5DBOG0A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
</li>
<li>
<p><code>clause default</code> 解锁参数 :</p>
<ul>
<li><code>clause_selector</code> :</li>
</ul>
<pre><code class="language-js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
  <span class="hljs-string">"raw_data"</span>: {
    <span class="hljs-string">"value"</span>: <span class="hljs-number">1</span>
  }
}
</code></pre>
<p>对应的解锁合约交易模板示例如下:</p>
<pre><code class="language-js"><span class="hljs-comment">// clause default</span>
{
  <span class="hljs-string">"base_transaction"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">"actions"</span>: [
    {
      <span class="hljs-string">"output_id"</span>: <span class="hljs-string">"a80552a346e271aaa7c71d0fa362a6b02aa844bb71a72934db64bc2b9906d0b9"</span>,
      <span class="hljs-string">"arguments"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
          <span class="hljs-string">"raw_data"</span>: {
            <span class="hljs-string">"value"</span>: <span class="hljs-number">1</span>
          }
        }
      ],
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account_unspent_output"</span>
    },
    {
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">3000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"2a62180553e70131f668639116d6d1e29417537766b5244cbe49fa6b36c5d7b0"</span>,
      <span class="hljs-string">"control_program"</span>: <span class="hljs-string">"0014905df16bc248790676744bab063a1ae810803bd7"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"control_program"</span>
    },
    {
      <span class="hljs-string">"account_id"</span>: <span class="hljs-string">"0ILGLSTC00A02"</span>,
      <span class="hljs-string">"amount"</span>: <span class="hljs-number">20000000</span>,
      <span class="hljs-string">"asset_id"</span>: <span class="hljs-string">"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"spend_account"</span>
    }
  ],
  <span class="hljs-string">"ttl"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-string">"time_range"</span>: <span class="hljs-number">1521625823</span>
}
</code></pre>
</li>
</ul>
</div></section><footer class="footer-container"><div class="footer-body"><img src="/img/dubbo_gray.png"/><div class="cols-container"><div class="col col-12"><h3>友情提示</h3><p>如果文档编辑有错误，请联系我们!</p></div><div class="col col-6"><dl><dt>文档</dt><dd><a href="/zh-cn/docs/00_index.html" target="_self">Overview</a></dd><dd><a href="/zh-cn/docs/13_architecture_overview.html" target="_self">Quick start</a></dd><dd><a href="/zh-cn/docs/06_build_environment.html" target="_self">Developer guide</a></dd></dl></div><div class="col col-6"><dl><dt>编辑文档</dt><dd><a href="https://github.com/bytomlabs/bytomlabs.github.io" target="_self">Github</a></dd></dl></div></div><div class="copyright"><span>Copyright © 2018 Bytom</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '';
  </script>
	<script src="/build/documentation.js"></script>
</body>
</html>