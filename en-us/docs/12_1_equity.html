<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="12_1_equity" />
	<meta name="description" content="12_1_equity" />
	<!-- 网页标签标题 -->
	<title>12_1_equity</title>
	<link rel="shortcut icon" href="/img/docsite.ico"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><div class="header-body"><a href="/en-us/index.html"><img class="logo" src="/img/dubbo_colorful.png"/></a><span class="language-switch language-switch-normal">中</span><span class="github"><a title="Github" target="_blank" href="https://github.com/Bytom/bytom"><img src="/img/github.png" alt=""/></a></span><div class="header-menu"><img class="header-menu-toggle" src="/img/system/menu_gray.png"/><ul><li class="menu-item menu-item-normal"><a href="//bytom.io" target="_self">Home</a></li><li class="menu-item menu-item-normal"><a href="//bytom.io/dev" target="_self">Developer</a></li></ul></div></div></header><div style="background:url(/img/banner.png)  top center no-repeat" class="bar"><div class="bar-body"><p>Bytom Develop Document</p></div></div><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span></span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/01_bytom.html" target="_self">Bytom</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/02_release.html" target="_self">Release</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/03_technology.html" target="_self">Technology</a></li><li style="height:216px;overflow:hidden" class="menu-item menu-item-level-2"><span>Client<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/04_1_bytom.html" target="_self">Bytom</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/04_2_simd.html" target="_self">Simd</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/04_3_spv.html" target="_self">SPV</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/04_4_vapor.html" target="_self">Vapor</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/04_5_gm.html" target="_self">GM</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/05_compile.html" target="_self">Compile</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/06_network.html" target="_self">Network</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/07_dashboard.html" target="_self">Dashboard</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/08_cli_guide.html" target="_self">Cli Guide</a></li><li style="height:216px;overflow:hidden" class="menu-item menu-item-level-2"><span>Mining<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/09_1_tensority.html" target="_self">Tensority</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/09_2_cpu.html" target="_self">CPU Mining</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/09_3_gpu.html" target="_self">GPU Mining</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/09_4_asic.html" target="_self">ASIC Mining</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/09_5_mining_pools.html" target="_self">Pool Mining</a></li></ul></li><li style="height:180px;overflow:hidden" class="menu-item menu-item-level-2"><span>Tools<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/10_1_blockmeta.html" target="_self">Blockmeta</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/10_2_bytom_kit.html" target="_self">Bytom Kit</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/10_3_byone.html" target="_self">Byone</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/10_4_bytom_spanner.html" target="_self">Bytom Spanner</a></li></ul></li><li style="height:252px;overflow:hidden" class="menu-item menu-item-level-2"><span>Dev Guide<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/11_1_architecture.html" target="_self">Architecture</a></li><li class="menu-item menu-item-level-3"><a target="_self">Transaction</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/11_3_mnemonic.html" target="_self">Mnemonic</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/11_4_websocket.html" target="_self">Websocket Request</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/11_5_json_rpc.html" target="_self">JSON-RPC Request</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/11_6_sdk.html" target="_self">SDK</a></li></ul></li><li style="height:180px;overflow:hidden" class="menu-item menu-item-level-2"><span>Smart Contract<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/12_1_equity.html" target="_self">Equity</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/12_2_smart_contract_build.html" target="_self">Smart Contract Build</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/12_3_contract_template.html" target="_self">Contract Template</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/12_4_contract_operator.html" target="_self">Contract Operator</a></li></ul></li><li style="height:72px;overflow:hidden" class="menu-item menu-item-level-2"><span>Docking Guide<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/13_1_mining_pool_docking_guide.html" target="_self">Mining Pool</a></li></ul></li><li style="height:180px;overflow:hidden" class="menu-item menu-item-level-2"><span>Glossary<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/14_1_transaction.html" target="_self">Transaction</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/14_2_address.html" target="_self">Address</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/14_3_account.html" target="_self">Account</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/14_4_block.html" target="_self">Block</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/15_error_code.html" target="_self">Error Code</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/16_faq.html" target="_self">FAQ</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/17_community.html" target="_self">Community</a></li></ul></li></ul></div><div class="doc-content markdown-body"><h1>Equity</h1>
<p><a name="93883fd2"></a></p>
<h2>Introduction of Equity contract</h2>
<p>Equity is a high-level language for expressing contract programs, user can be write contract which compiled to program for <a href="https://github.com/Bytom/bytom">Bytom</a>. Equity contracts mainly describe the management of various assets on <code>Bytom</code>. The main features of the contract are as follows:</p>
<ul>
<li>the UTXO of <code>Bytom</code> is <code>BUTXO</code>, and the blockchain records a book consisting of a number of different types of <code>UTXO</code>. Each <code>UTXO</code> has two important attributes: the asset number <code>assetID</code> and the number of assets <code>amount</code>. Generally, the specified number <code>amount</code> of asset <code>assetID</code> is Expressed abstractly as a <code>UTXO</code>.</li>
<li>All on-chain assets are locked in the contract program. Once the number <code>valueAmount</code> of asset<code>valueAsset</code> (ie <code>UTXO</code>) is unlocked by a contract, it is only meant to be locked by one or more other contracts.</li>
<li>The contract protects the asset value is that the contract program execute successfully in the virtual machine only by entering the correct unlocking parameters.<br />Therefore, the <code>Equity</code> language is designed to describe which assets are locked with smart contracts and define under which conditions the specified assets can be unlocked.</li>
</ul>
<p><a name="0ad01ccb"></a></p>
<h3>Components of contract</h3>
<p>An <code>Equity</code> program consists of a contract which defined with the <code>contract</code> keyword. A contract definition has the form:<br /><code>contract ContractName ( parameters ) locks valueAmount of valueAsset { clauses }</code></p>
<ul>
<li><code>ContractName</code> contract name is an identifier, defined by user.</li>
<li><code>parameters</code> list of contract parameters, which must conform to the basic type of contract language.</li>
<li><code>valueAmount</code> amount of asset, the identifier can be customized by the user.</li>
<li><code>valueAsset</code> type of asset, the identifier can be customized by the user.</li>
<li><code>clauses</code> list of clauses(ie, functions), a contract contains at least one <code>clause</code>.</li>
</ul>
<p><a name="195da38a"></a></p>
<h3>Component of Clause</h3>
<p>Each <code>clause</code> describes one way to unlock the value in the contract. A clause has the form:<br /><code>clause ClauseName ( parameters ) { statements }</code></p>
<ul>
<li><code>ClauseName</code> name of clauses, which is defined by users.</li>
<li><code>parameters</code> list of clauses.</li>
<li><code>statements</code> list of statements, a contract contains at least one <code>statements</code>.</li>
</ul>
<p><a name="Parameters"></a></p>
<h3>Parameters</h3>
<p>Contract and clause parameters have names and types. A parameter is written as:</p>
<ul>
<li><code>name : TypeName</code><br />The list of parameters is:</li>
<li><code>name1 : TypeName1 , name2 : TypeName2 , …</code><br />Adjacent parameters sharing the same type may be coalesced like so for brevity:</li>
<li><code>name1 , name2 , … : TypeName</code><br />so that these two contract declarations are equivalent:</li>
<li><code>contract LockWithMultiSig(key1: PublicKey, key2: PublicKey, key3: PublicKey)</code></li>
<li><code>contract LockWithMultiSig(key1, key2, key3: PublicKey)</code><br />Available types:</li>
<li><code>Integer</code> <code>Amount</code> <code>Boolean</code> <code>String</code> <code>Hash</code> <code>Asset</code> <code>PublicKey</code> <code>Signature</code> <code>Program</code><br />These variable types are described in <code>Basic Type</code>.</li>
</ul>
<p><a name="97e267af"></a></p>
<h3>Component of Statement</h3>
<p>The <code>statement</code> of contract, in addition to the basic statement <code>verify</code>、<code>lock</code> and <code>unlock</code>, it contains the extended statement <code>define</code>, <code>assign</code> and <code>if-else</code>.</p>
<ul>
<li><code>verify</code> statement is to verify that the result of the expression is <code>true</code>, it has the form:: <br /> <br /><code>verify expression</code><br /> <br />The expression must have Boolean type. Every verify in a clause must evaluate as true in order for the clause to succeed. The examples are as follows:
<ul>
<li><code>verify above(blockNumber)</code> tests that the current block height above the given <code>blockNumber</code>.</li>
<li><code>verify checkTxSig(key, sig)</code> tests that a given signature matches a given public key and the transaction unlocking this contract.</li>
<li><code>verify newBid &gt; currentBid</code> tests that <code>newBid</code> is greater than <code>currentBid</code>.<br /></li>
</ul>
</li>
<li><code>lock</code> statement has the form: <br /> <br /><code>lock valueAmount of valueAsset with program</code> <br /> <br />The <code>valueAmount</code> represents the number of assets, the <code>valueAsset</code> represents the asset type, and <code>program</code> represents the receiving object with <code>Program</code> type.<br /></li>
<li><code>unlock</code> statement has the form: <br /> <br /><code>unlock valueAmount of valueAsset</code><br /> <br />The <code>valueAmount</code> represents the number of assets, the <code>valueAsset</code> represents the asset type, The <code>unlock</code> statement indicates that the unlocked asset can be arbitrary receiving object(without specifying the new contract).<br /></li>
<li><code>define</code> statement has the form: <br /> <br /><code>define identifier : TypeName = expression</code><br />or<br /><code>define identifier : TypeName</code> <br /> <br />The <code>identifier</code> is a variable whose data type is <code>TypeName</code>. If the custom variable has no assignment, the variable must be assigned in the <code>assign</code> statement. The examples are as follows:
<ul>
<li><code>define value : Integer = amount</code> defined a integer variable <code>value</code> which assigned with <code>amount</code>.</li>
<li><code>define value : Integer = amount + shift</code> defined a integer variable <code>value</code> which assigned with <code>amount + shift</code> expression.</li>
<li><code>define value : Integer</code> defined a integer variable without assigned, this variable needs to be assigned in the <code>assign</code> statement, otherwise it will report &quot;variable is not assigned&quot;.<br /></li>
</ul>
</li>
<li><code>assign</code> statement has the form: <br /> <br /><code>assign identifier = expression</code> <br /> <br />The <code>identifier</code> must be a variable which defined in the <code>define</code> statement, besides, it is forbidden to modify variables in <code>contract</code> and <code>clause</code>. The example is as follows:
<ul>
<li><code>assign value = amount</code> assigned with <code>amount</code>, the type of the <code>amount</code> must be same with <code>value</code>.<br /></li>
</ul>
</li>
<li><code>if-else</code> statement has the form: <br /> <br /><code>if expression { statements }</code><br />or<br /><code>if expression { statements } else { statements }</code><br /> <br />The <code>expression</code> is the the judgment condition of the <code>if-else</code> statement, and the result of this expression must be a <code>bool</code> type. it execute the <code>statements</code> block below <code>if</code> When the result is <code>true</code>, otherwise Execute the <code>statements</code> block under <code>else</code>.</li>
</ul>
<p><a name="c15a0926"></a></p>
<h3>Basic Type</h3>
<p>The available types:</p>
<ul>
<li><code>Boolean</code> value is <code>true</code> or <code>false</code>.</li>
<li><code>Integer</code> - the range of value is <code>[-2^63, 2^63-1]</code>.</li>
<li><code>Amount</code> - the range of value is <code>[0, 2^63-1]</code>.</li>
<li><code>Asset</code> - assetID, the length is 32 bytes.</li>
<li><code>Hash</code> - hash, the length is 32 bytes.</li>
<li><code>PublicKey</code> - publickey, the length is 32 bytes.</li>
<li><code>Signature</code> - signature should be constructed by <code>root_xpub</code> and <code>derivation_path</code> according to <code>publickey</code>, and only be used in the parameter list of <code>clause</code>.</li>
<li><code>Program</code> - receiver program.</li>
<li><code>String</code> - normal string.</li>
</ul>
<p><a name="Expression"></a></p>
<h3>Expression</h3>
<p>The expression can be used in the <code>expression</code> which is in statement. The available expression categories are as follows:</p>
<ul>
<li>Unary expression
<ul>
<li><code>- expr</code> : negates a numeric expression</li>
<li><code>~ expr</code> : inverts the bits in a byte string<br /></li>
</ul>
</li>
<li>Conditional expression, each of the following requires numeric operands (Integer or Amount) and produces a Boolean result:
<ul>
<li><code>expr1 &gt; expr2</code> : tests whether <code>expr1</code> is greater than <code>expr2</code></li>
<li><code>expr1 &lt; expr2</code> : tests whether <code>expr1</code> is less than <code>expr2</code></li>
<li><code>expr1 &gt;= expr2</code> : tests whether <code>expr1</code> is greater than or equal to <code>expr2</code></li>
<li><code>expr1 &lt;= expr2</code> : tests whether <code>expr1</code> is less than or equal to <code>expr2</code></li>
<li><code>expr1 == expr2</code> : tests whether <code>expr1</code> is equal to <code>expr2</code></li>
<li><code>expr1 != expr2</code> : tests whether <code>expr1</code> is not equal <code>expr2</code><br /></li>
</ul>
</li>
<li>Bitwise operation expression, these operate on byte strings and produce byte string results:
<ul>
<li><code>expr1 ^ expr2</code> : produces the bitwise XOR of its operands</li>
<li><code>expr1 | expr2</code> : produces the bitwise OR of its operands</li>
<li><code>expr1 &amp; expr2</code> : produces the bitwise AND of its operands<br /></li>
</ul>
</li>
<li>Numerical expression, these operate on numeric operands (Integer or Amount) and produce a numeric result:
<ul>
<li><code>expr1 + expr2</code> : adds its operands</li>
<li><code>expr1 - expr2</code> : subtracts <code>expr2</code> from <code>expr1</code></li>
<li><code>expr1 * expr2</code> : multiplies its operands</li>
<li><code>expr1 / expr2</code> : divides <code>expr1</code> by <code>expr2</code></li>
<li><code>expr1 % expr2</code> : produces <code>expr1</code> modulo <code>expr2</code></li>
<li><code>expr1 &lt;&lt; expr2</code> : performs a bitwise left shift on <code>expr1</code> by <code>expr2</code> bits</li>
<li><code>expr1 &gt;&gt; expr2</code> : performs a bitwise right shift on <code>expr1</code> by <code>expr2</code> bits<br /></li>
</ul>
</li>
<li>Other expression：
<ul>
<li><code>( expr )</code> : is expr</li>
<li><code>expr ( arguments )</code> : is a function call, where arguments is a comma-separated list of expressions; see built-in functions below</li>
<li>a bare identifier is a variable reference</li>
<li><code>[ exprs ]</code> : is a list literal, where exprs is a comma-separated list of expressions (presently used only in checkTxMultiSig)</li>
<li>a sequence of numeric digits optionally preceded by <code>-</code> is an integer literal</li>
<li>a sequence of bytes between single quotes <code>'...'</code> is a string literal</li>
<li>the prefix <code>0x</code> followed by <code>2n</code> hexadecimal digits is also a string literal representing <code>n</code> bytes</li>
</ul>
</li>
</ul>
<p><a name="655d187a"></a></p>
<h3>Built-in Functions</h3>
<p>The available built-in functions:</p>
<ul>
<li><code>abs(n)</code> returns the absolute value of the value n.</li>
<li><code>min(x, y)</code> returns the smallest of the two values x and y.</li>
<li><code>max(x, y)</code> returns the largest of the two values x and y.</li>
<li><code>size(s)</code> takes an expression of any type and produces its <code>Integer</code> size in bytes.</li>
<li><code>concat(s1, s2)</code> takes two strings and concatenates them to produce a new string.</li>
<li><code>concatpush(s1, s2)</code> takes two strings and produces the concatenation of s1 followed by the BVM opcodes needed to push s2 onto the BVM stack. This is typically used to construct new VM programs out of pieces of other ones.</li>
<li><code>below(height)</code>  takes a <code>unsigned integer</code> and returns a <code>Boolean</code> telling whether the current block height below to <code>height</code>.</li>
<li><code>above(height)</code> takes a <code>unsigned integer</code> and returns a <code>Boolean</code> telling whether the current block height above to <code>height</code>.</li>
<li><code>sha3(s)</code> takes a byte string and produces its SHA3-256 hash.</li>
<li><code>sha256(s)</code> takes a byte string and produces its SHA-256 hash.</li>
<li><code>checkTxSig(key, sig)</code> takes a <code>PublicKey</code> and a <code>Signature</code> and returns a <code>Boolean</code> telling whether <code>sig</code> matches both key and the unlocking transaction.</li>
<li><code>checkTxMultiSig([key1, key2, ...], [sig1, sig2, ...])</code> takes one list-literal of <code>PublicKeys</code> and another of <code>Signatures</code> and returns a <code>Boolean</code> that is true only when every <code>sig</code> matches both a key and the unlocking transaction. Ordering matters: not every key needs a matching signature, but every signature needs a matching key, and those must be in the same order in their respective lists.</li>
</ul>
</div></section><footer class="footer-container"><div class="footer-body"><div class="copyright"><span>Copyright © 2019 Bytom</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '';
  </script>
	<script src="/build/documentation.js"></script>
</body>
</html>