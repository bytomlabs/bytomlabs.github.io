{
  "filename": "13_key.md",
  "__html": "<h1>Mnemonic</h1>\n<p>Bytom already implemented BIP39, for more information please visit: <a href=\"https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki\">https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki</a></p>\n<h1>Generate Root Private Key</h1>\n<ul>\n<li>Input: 64 byte of seed, which can be random generate or calculate from mnemonic.</li>\n<li>Output: 64 byte of private key</li>\n</ul>\n<pre><code>$ xprv = hmac(sha512, seed, []byte{'R', 'o', 'o', 't'})\n$ xprv[0] &amp;= 248\n$ xprv[31] &amp;= 31\n$ xprv[31] |= 64\n</code></pre>\n<h1>Private Key Calculate Public Key</h1>\n<ul>\n<li>Input: 64 byte of private key</li>\n<li>Output: 64 byte of public key</li>\n</ul>\n<pre><code>$ xpub[:32] = edwards25519.GeScalarMultBase(xprv[:32])\n$ xpub[32:] = xprv[32:]\n</code></pre>\n<h1>Derives the Child Private Key</h1>\n<ul>\n<li>Input: 64 byte of private key, derive path byte array</li>\n<li>Output: 64 byte of child private key</li>\n</ul>\n<pre><code>$ xpub = xprv.XPub()\n$ child_xprv = hmac(sha512, []byte{'N'} + xpub[:32] + derive_path, xpub[32:])\n$ child_xprv[0] &amp;= 248\n$ child_xprv[29] &amp;= 1\n$ child_xprv[30] = 0\n$ child_xprv[31] = 0\n$\n$ carry = 0\n$ for i := 0; i &lt; 32; i++ {\n$     sum := int(xprv[i]) + int(child_xprv[i]) + carry\n$     child_xprv[i] = byte(sum &amp; 0xff)\n$     carry = (sum &gt;&gt; 8)\n$ }\n</code></pre>\n<h1>Derives the Child Public Key</h1>\n<ul>\n<li>Input: 64 byte of public key, derive path byte array</li>\n<li>Output: 64 byte of child public key</li>\n</ul>\n<pre><code>$ child_xpub = hmac(sha512, []byte{'N'} + xpub[:32] + derive_path, xpub[32:])\n$ child_xpub[0] &amp;= 248\n$ child_xpub[29] &amp;= 1\n$ child_xpub[30] = 0\n$ child_xpub[31] = 0\n$ f = edwards25519.GeScalarMultBase(child_xpub[:32])\n$ p = edwards25519.Point(xpub[:32])\n$ child_xpub[:32] = edwards25519.AddPoint(p, f)\n</code></pre>\n<h1>Expand Private Key for Sign</h1>\n<ul>\n<li>Input: 64 byte of private key</li>\n<li>Output: 64 byte of expanded private key</li>\n</ul>\n<pre><code>$ expanded = hmac(sha512, xprv, []byte{'E', 'x', 'p', 'a', 'n', 'd'})\n$ expanded[:32] = xprv[:32]\n</code></pre>\n",
  "link": "/en-us/docs/13_key.html",
  "meta": {}
}